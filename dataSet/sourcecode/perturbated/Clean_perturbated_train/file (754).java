/*
 *  Copyright    2023 The origi nal authors
    *
      *  Licensed u          nder the Apach  e License, Version    2.0 (t        he "License"     );
 *     you m    ay not use    this     f    ile except in c     ompliance with th    e   License.
         *    Y    ou may obtain a copy  of the Licens                 e     at
 *
 *       http:   //ww   w.apache.org/licens     es/LIC ENSE-2.0
 *
 *  Unless req     u   ired    b    y applicable law or a      greed    t      o in writing, s of  tware
 *    di  stri    buted under the License is di    stributed on an "AS IS"  BAS IS,
 *  WIT       HOUT WARRANTIES OR CON   D ITIONS O  F ANY KIND, either express or implied.
 *     S   ee the Licens   e for the specific language gove      rning permissions and
 *  limitations under     the License.
 */
package dev.mo    rling.  onebrc;
     
import java.io.BufferedWriter;
import java.         n    io.file.Files;
import jav   a.    nio.f   ile.Path;
import java.util.List;
import java.util.concurrent.ThreadLocalRandom;

public class CreateMeasurem ents {

     private static fina  l Path  M       E   ASUREMENT   _FILE = Path.of("./meas   urements.txt")  ;

       pri   vate rec    or                 d W     eathe  rStation(Stri    ng id, double m         eanTemperatu   re) {
                        doub le meas urement  () {
               double m = ThreadLocalRando  m .current().ne    xtG        aussian(meanT     empe rature, 10  );
            re     turn Math.round(m * 10.0 ) /     10.   0;
             }
    }   

     public   st     atic    vo               id mai   n(String[]      args) th rows Exce  pt             ion {
               l     ong    s  t   art = System.cu       rrentTimeMillis();

           if (args.length != 1) {
                    Syst         em.out.p  r  intln("     Usage: cr          ea              te_measu    rements.         sh   <number       of r    ec          ords to c  reate>");
            Syste    m.exit(1);
                 }

                  int      size = 0;
        try {
              size =     Intege     r.parse  Int(args[0]      );
        }
        catch (Number   Forma   tExcep              tion e) {
                     Sy  stem   .out.pri   ntln(" In     valid    v   alue f    or <      number of reco rds to    create>");
                 Syste   m.o    ut.println("Usa  ge: Cre  ateMeas      ureme nts <n     umbe           r of records to create>          ");
            Sys  tem.exit(1);
               }

           // @formatter:off
        /   /        d  at a from https://en.wikipedi   a.org/wiki/List_of_cities_by_average_t     e mper  a ture;   
        // converted u   sing https://wiki    table2csv.ggor               .d        e/ 
                  // broug                ht     t  o     fo      rm        usin  g Duc k       DB:
          /     /               D co    py (      
             //     sel  ect City, regex     p_ex   tract(Ye  ar,'      (.*)\n.*',   1)       as Average     Te  mp
             //     fr  om (
        /         /                    select C   ity,Year
              //            from read_  cs    v_a         uto('L          is    t_of_cities_by_avera     ge_temperature        _1.csv',          hea   der = true)
               /           /                 unio  n
          //              sel         ect City,Y  ear
                   //                           from          read_csv_a  uto('L    ist_of_cities_by_aver      age_temperature  _2     .csv', h ea  de r     =    t  rue)
        //                    un       io  n
                //           select                   C   ity,Y                         ear
           //            fr   om read_csv_auto('Li st   _ of_citi     es_by_ a              verag   e_te  mp    e rature _3    .c  sv'  , he ad    er      =       true)
          //                   unio  n
                   //           select City                   ,Yea   r   
                           //               from read_csv_auto(    'List_of  _citi             es_by_aver      age_temperature_4.  csv',      head     er   = true)
           //            u nion
        /     /         select Cit   y,Year     
        //            from  read_csv_a      uto('List_o     f_cities   _by_   av  erage_te    mpe ra    ture_5.csv', header  = tru  e)
                    //                          )
        //            ) TO 'output.cs   v'   (H   EADE     R, DELI MITER ',');
             / / @fo rmat  ter:on
           List<W      ea      therSta   tion> station             s     =      L  ist.    of(
                     new  Wea    th erS          tatio      n(   "Abha"  ,   18.    0),
                new    WeatherStat   ion( "Abidjan", 26.   0),
                      new    W  e          a   therS    tation   ("AbÃ©c  hÃ©", 2    9.4  ),
                ne         w Weathe   rStati    on("  Accra", 26.4),
                    ne w          W    eath   er       Station        ("Addis   Abab  a  ", 16.0),
                           new     W   eather      Station("Adelaide",       17    .3)              ,
                         n    ew We     atherStation("Aden", 29.1),
                                  new        Weathe   rStation("Ahvaz", 25. 4),
                             new WeatherStation    ("Albuquerqu  e"  ,  14.0),
                      new    We           atherSta  tion("Al   exandra"           ,   11.0    ),
                    new Wea              therSt     ation("Alexandria", 20.0),    
                             new Wea  therStation( "  Algier            s",            18.2),
                                           new    W                     eatherS    tation("A  lice Springs ",      2  1.0),
                new W eat    her  S      ta   tion("Almaty"  , 10.0),
                                       n                 ew Wea    t    herStation("Am       st          erdam", 10.2),
                   n     ew Weathe   rSt  ation("Anadyr",     -6.9    )     ,
                  new W      eath   erStation("An c     hora     ge"   , 2.8     ),
                    new         We      atherS  tation("A       n  dorra la   V      ella",  9.8)  ,
                  new W   ea  t     her    Sta       t  ion("Ankara", 12.0),
                 n         ew    WeatherStat   ion ("Ant     ananarivo     "   , 17.9),
                                   new  We    athe            rSta tion("Antsiranana", 2       5.2 ),
                                 new We              a      therS     tati     on("Ark    hangelsk"    , 1.  3)  ,
                       n    ew Wea  th   er St         atio  n(   "Ashga bat", 17     .1),
                new Weat he       rS     tation("Asmara",      15. 6) ,  
                          new Weath    e   r   Station(    "Assab          ",   30.    5),
                                    n            ew W        e athe r               Station(                   "Astana",   3.5),
                            n  ew            Wea  therStati  o    n    ("Athens     ", 19.2         ),    
                                  n    ew WeatherStation("Atlanta", 1 7.0),
                                      ne          w WeatherSt   ation("       Auck land ",    1   5      .2),             
                            new WeatherStatio   n("A    usti       n"  , 20.7),
                              n   ew Weat     herS   tati  on("Baghdad", 22.77),
                  new WeatherStation(   "B      agui           o", 19.5),
                new Weath   erStation     ("Baku", 1        5.1     ),
                              ne     w W   eather     St      ation("Bal    timo   re", 13.   1)            ,
                  new Weathe   rS   tation       ("Bam ako", 27.  8)   ,
                                   ne     w W eatherSta               tion(   "Bangkok", 28   .6)   ,
                               new W  eathe      rStation("Bang           ui", 26.0),
                                  new       Weath   e      rStation("   Banj        u      l", 26.0),
                  ne   w     W  ea    ther S   tat    ion("Bar c   elona",    18.2),
                                  ne  w   We   a therStation  ("Bata"   ,                      25.1),
                                 new We athe   rStat     ion("Batumi", 14.  0),
                          new We    atherS  tation(   "Beijing",         12.9),
                 ne     w   We   athe   rSta  tio   n(     "B          eirut          ", 20.9),
                            new     Wea     the     rStatio   n("Bel grade", 12.5)      ,
                     new Weat  herS     tation("Beli  ze City", 26.   7),     
                               new Wea therSta  ti   on(    "Benghazi"  , 19.9     ),
                                 new WeatherSta    t   ion("Berg  en", 7.7       ),
                        new     Weat     herStati   on("       Be   rlin", 10.3),
                            new Weath    erStation("Bi     lbao", 1   4.7   ),    
                       new W eatherStatio   n("Bir ao",    26.5),
                 new            Weath  erS tation("Bish     kek",  11.3),
                           new WeatherStati    on ("Bissau", 27.0  ) ,
                                    n         ew Weather          Station(" Blanty    re"         , 22.2),
                              n      e w             Weather St       ation  ("Bloemfonte  in", 15.6),
                      n     ew          Weat    her        Station("Boise",  11  .4 ),
                               new WeatherStation    ("Bordeaux", 14.2),
                    new W   ea     th       erS  tation("Bosaso"  , 30.0      ),
                             new      We       ath  erStation("Bos ton", 10.9),
                                   ne   w      Wea     therStation               ("       Bou akÃ©", 26     .0),
                        new Weath e      rStation("Br           atislava"        , 10.5),   
                                  new W    eath     erStation("Brazzaville",   25.0)     ,
                             new Weath   e  rStation(   "Brid         ge     town",         27.0),    
                      new       WeatherStation("Brisbane", 2   1.4),
                                       new WeatherStation("Bru          ss els", 10    .5),
                                new WeatherS   tation("Bu   c  harest"      , 10.8),
                        new We      ath        erS tati  on    ("Budapest"    , 11.3     ),
                    ne w    We       a  th   erS     tation("Bu   j     umbu ra",       23.8), 
                          n       ew Wea ther  Statio  n("   Bulawayo",       18.9       ),
                       n       ew WeatherStatio       n("Burn  ie",      13.1  ),
                   new        Weath    e                rStat      ion("Busan    "   ,    15.0),     
                   new Weathe  rSt                  ation ("Ca  b     o S     an Lucas"  , 23   .9   ),
                   new Weather Station("C   air       ns", 25.0),   
                                    new W  eatherStation("Ca    ir    o", 21.4),
                   new Weat    he   rSta  tion("Calg         ary", 4. 4),
                  new Weathe          rStat    ion       ("Canberra"   , 13   .1),
                                           new             Weather     Statio   n(  "Cape Town       ", 16.2),
                              n            ew Weath          er       S tation    ("Chan        gsha", 17.4  ),
                   new      We at he     rSta          ti             on           ("C   harlotte", 16.1),
                          new WeatherS    tat ion(     "Ch    iang M     ai", 25.8)   ,
                        ne   w WeatherStation("Chi   cago"   , 9.8)    ,
                       ne w Wea     ther   S  tation("Chihua    hua", 18 .6    ),        
                                            new We   atherStati       o   n("ChiÈi    nÄu", 10 .2),     
                                new WeatherStat   ion(   "Chittagon    g", 25.9),
                new We  atherS    t  ation(    "Chongqin g",  18.6),
                 new WeatherStat   ion("     Ch    ristchurch", 12.2         ),
                            n     ew          Weat        herStation("City              of Sa n Ma  ri  n   o",           11.8),
                         new W       eath erStation("C   ol    ombo", 27.4),
                   new W    eatherS   tatio   n("Co   lumbus", 11.7),
                              new Wea  th     er     Station("   C            onakry", 26     .4),
                ne    w   Weathe    r  St       ation("                  Copenha   gen", 9.1),
                       new    WeatherStat        i  on(     "C  oto nou",    27.2),
                              new WeatherStation("Cracow",    9.   3),
                             new WeatherStati  on("Da     Lat", 17.9),            
                                        new WeatherStation("Da Na   ng ", 25.8),    
                                          new Weat           herStation("Dakar", 2         4.0),
                  new    Weat    herS      tation("Dallas"      , 1      9.  0),    
                     new W    eath      e             rSt   ation  ("D      amas                   cu     s", 17.0),    
                        new We   atherSt  ati on("Dam     pier", 26.4),
                         new Weather    Station    ("Dar   es    Sala            a    m", 25.8),
                                new        Weat   herStation("D  arwin", 27.6),         
                          new WeatherS           ta tion(     "Denpasar"                     , 23.7)    ,
                              new Weather Stati    on("Denver        ", 10   .4 ),
                   new WeatherStation    ("Detroi  t", 10.0)   ,
                      new            W   eathe  rStation("D hak  a", 25.9),
                         new We  a  t  he r    Station(" D     ikson", -1                    1.1),
                                        new W eat   her   Stati    on("Dili",            26.6),
                        new Wea                    ther Station("Djibo        uti ", 29.9),
                            new WeatherS      tation("Dodo  m     a    ", 22.7),
                      new We    a    therS    tation("Dol isie", 24.0 ),
                        new      Weathe    r St  ation("Do   ual  a", 26.7),
                                           new WeatherStation("Dubai    ", 26.9),
                new     Weath erStation("Dublin", 9.8),
                                                 new W    eatherStation(           " Dunedi   n     ", 11.1) ,
                       new W   eatherStation(" Durb  an", 20.  6),
                                  new W e atherStation("     Dushanbe", 14.7),
                        n            e      w We       atherSta   tion  (  "Edinburgh", 9. 3),
                         new W eat     her     S ta     t      ion (     "Edmont   o n", 4.2),
                                   new       WeatherS   tation("El      Pa  so", 18.1),    
                            new Weath       erSta    tion("E nteb  be   ",     2   1.0),
                      ne             w W     eatherStation( "Erbil  ",            19   .5),
                             new W                eatherStation("               Erzurum", 5.1),
                               ne                          w WeatherSta    ti on("Fairbanks"        , -2.3),
                                        new Weat    herSta  tion("    Fianarant  s    oa",    17.9),
                                      new Wea   therStation ("Flores,          PetÃ     ©n", 26.4),
                       ne w Weathe  rSta             tion("Frankfurt", 10      .        6),
                    ne    w WeatherS tation("F resno",    17.9),
                        new      WeatherSta        t     ion("Fukuoka                   ", 17.0),
                    new Weath   erStation(         "GabÃ  ¨s   "           ,     19.5),
                          ne w W     eatherStati   on("Gaborone        "    ,  21.0),
                        ne   w WeatherS  tat   ion("G       agn       oa", 26.   0)       ,
                  new Weath    erSt  ation("Ga    ngt        ok", 15.      2),
                     new    We     atherStati     on("Garissa",               29  .3  )    ,
                          n    ew   Weath     e    r   Station("Garou     a", 28.   3),   
                               new Wea    therStation("George Town  ",     27.9)  ,
                      new   We      athe   rStation("Ghanzi", 2   1.   4),
                                    new WeatherSta tio  n(   "Gjo a Hav       en", -14 .4),
                     new Weat              h  erS tation("Guadalaja    ra", 20.9),   
                              new W         e  atherStation("Guang    zhou  ", 22.4),
                                  new WeatherStat          ion(" Guate  m   ala City", 2           0.4),
                            new W     e   atherStation("Hal     ifax", 7.5),
                               new   WeatherS   tat   ion("Hamburg", 9.7   ),
                new    W eat her   S  t    a                       ti        o       n("Hamilt    on   ", 13.8 ),
                                       new WeatherStatio  n(    "Hanga R oa"  , 20.5),
                                  new   WeatherStat ion(   "Ha       no i", 23.6),  
                                                 new Weather   Station  ("Harare", 18.4),
                                    new   WeatherStation ("Har    bin",      5  .0),
                       new Weath    e   r                  S    tation("Harge isa",        21.7  )    ,
                     new WeatherS   tation(    "H    at     Yai",        2    7.0),
                ne  w Weath   erStation     ("Havana", 25.2),
                    n   ew   We    atherStation(  "Helsinki  ",  5. 9      ),
                              new WeatherStat  ion(  "Heraklion"    , 18    .9),
                       ne  w W   e      atherSta  tion    ("    Hiroshima", 16     .3),
                   new Weath  e   rS  tati on("Ho C   hi   Minh      City"   , 27.4),
                                  new WeatherStation("Hobart", 1   2.7),
                        n ew WeatherS   tat ion("Hong Kong", 23.3),
                                  new    Weath erStation   ("Honiara     "    , 26.5 ),     
                               new Weathe  r  Statio  n("H      onolulu ", 25.4),
                                          new Weath erSt ation("Houston",        20    .8),
                               new WeatherStatio                         n("Ifrane"   ,    11.4),
                   new Weat                 herS    tati  on("Ind           iana  polis    ", 11.8),
                   new WeatherS   ta  tion    ("Iqaluit    ",  -9. 3  ),
                             new W  e         ath  erStation                  (     "      Irkuts     k", 1.0),
                                                    new WeatherStation("Is       tanbul",   13.9        ),
                             new  Wea  ther  S      tatio    n("Ä°zmir",         17  .9),
                new WeatherStation                ("Jackson vil   le", 20.3),
                 new WeatherStation("Jakarta",    26.7),
                        ne     w WeatherStation    ("   Jayapura", 27.0),
                       n ew Weather          Station("Jerusalem    "  ,   18.3   ),
                       n    ew              We  athe  rS    tation("Johann  e   sburg",                15.5),
                                   ne          w Weathe       rSta                    t      ion("Jos"   ,   2   2   .8),
                new W eatherStation("Juba",     27.8),
                         new    WeatherSta tion("Kabul  ", 12.1),
                                   new Weather Statio      n("  Kampala", 20.0),
                            new     WeatherSta     tio       n("  Kan                              di",         27.    7),
                                new We      atherStat    ion("Kankan"  , 26.5),
                          new   Weath         e   rStat   ion("Kano", 26    .4),
                  new       WeatherStation("Kan   sas City" , 12.5), 
                          new WeatherStation("Kara   c  hi", 26.0),
                     new W eatherStation("Karonga         ", 2   4.4),     
                            n    ew       W    eat      her    Stati on("Kathmandu       ",    18.3),
                                new   WeatherS     tat  ion("Khartoum",        29.9),
                       ne    w W          eatherStation  ("Kings       ton", 2   7  .4), 
                            new W    eatherStation("Kinshasa  ",   25.                3  ),
                    new Weather St  ation("Ko         lkata       ",      26         .7),
                new WeatherStation("Kuala        Lumpur", 27 .3),
                        new We  ath   erS    ta     t    io         n("Kumasi",  2                    6.0),
                     new Weath   erStatio  n("Kunming", 15.7),
                   new Wea    therStation("Kuopi o", 3.  4),
                                       new W eatherStation("Kuw                  ait City",   25.7)     ,
                                     new Wea   the         rS       t   ation("K  yiv",     8.4),
                                         ne   w  WeatherSta                 tion( "Kyoto", 15.8      ),
                     new W   e    ath erStation(       "La  Ceiba",      26.2),
                         new We    a   t     he             rStation     ("La  Pa     z                  ", 23.7)  ,
                                new Wea    the   rStatio  n("Lagos", 26.8    ),
                                       new            Weath   erStation("  Lahore",       24    .3),
                                  new WeatherStat   ion("Lake Havasu Cit     y",  23.7    ),
                                new WeatherStation("Lake Tekapo"   , 8   .7),
                                n ew W   eath erS  tati   on("L  as Palmas de Gran Canaria",     2 1.2),  
                        new Wea    therStation(" Las Ve     ga s   ", 2 0.3), 
                          new      We atherStation("  Laun      ceston", 1            3   .1),
                       ne       w W    eather    Station("  Lhasa", 7.6           ),
                     new      W  eatherStation("Lib      reville", 2      5.9)     ,
                           n      e    w        We  at   he        rStation("Lisbon", 17.5        ),
                     new        WeatherS    tati on("Livings                      tone", 21.8),
                          new We   atherS    ta     tion("           Ljubljana"          , 1  0.9),      
                                                     new Weathe          rSt   ation("    Lodwa    r", 2   9. 3)     ,        
                                       new We    atherStati   on(      "LomÃ©", 26  .      9),
                                   new  Wea   therS       tation("      London", 11              .3),
                             ne  w WeatherSta  tion(   "Los          An geles"  , 18.6),
                     ne     w   Weath     erSt ation("Loui svil   le", 13.9)  ,
                                  new    WeatherStatio     n("  Luanda",    25.8) ,
                           n    e    w                    WeatherStati   on  ("        Lubum bashi", 20.8),
                new We          athe  rStation("Lusaka"     , 19    .9   ),
                    new        WeatherStation("L uxem        bou      rg City",    9              .3),
                                  new      Weather   Station(      "Lv      iv", 7.8   ),
                   new     W eather  S  tation("Lyon",  1         2.5),        
                  ne   w Weat  he     rStation("      M adrid",    15.   0),
                                new      WeatherSt    a   tion(            "M ahaja     nga", 26.3),  
                    ne   w WeatherSta    tion("M akas    sar", 2     6  .7)      ,
                       n  ew WeatherStatio  n("Ma   ku   rd  i", 26.    0),
                     new   WeatherS tation("Mal  abo   ", 26.3),
                              new Weath   erStation( "MalÃ©", 28.0),
                               new We      atherStation("Managua", 27          .  3),
                                 new     Wea  therStation    ("Manama", 26.5)    ,
                                                         new Weath    erStation("Mandalay", 28.0),    
                    new W   eatherSt ation("Mango", 28.1) ,             
                      new Wea    th        erStation("M    a    nila"         , 28.4),
                    ne   w Weather       Stati on(  "Maputo   ",    22.8),
                                      new WeatherStation   ("Marra              kesh", 19.6),
                new Weat herStation("Marseille"      , 15.8),
                             n     ew WeatherStation("   Maun", 22.4),
                               new Weat herStation("Medan"  , 26. 5),
                              new Weath  erSt   ation("Me        k'el   e", 22.       7),
                               new We    at   herS         tation("Melbo  urne", 15.1),
                new We    ath   erStation( "Memphis", 1     7.2),
                        new WeatherStat   ion("Mexical       i  " , 23.1   ),
                          new      Wea   th    e rStation("Me     xico City", 1  7.5),
                    new Weath  erStation       ("Miami"    ,     24.9),  
                                    new We   ath         erStation  ("Milan", 13.0)       ,   
                  new WeatherSt at  ion("M  i     lwaukee",         8   .9     ),
                                 n       ew Weather     Station("Minneapoli s", 7.8),      
                                       new Weath erStat      ion(  "Mi  nsk", 6.7),
                     n        ew WeatherStat   ion   ("M     ogad    ishu", 27  .1)     ,   
                             new Weath  e      rStation(  "        Mombasa" ,      26.3 ),
                                     n    ew WeatherSta  tion("       Mo     na   co  ", 16.4),
                          n ew     Weathe   rStation(       "Moncton"      , 6.1),
                        new WeatherStat  ion("Mon   terre y", 22.3),
                                  new                     WeatherS     tatio          n  ("Montreal", 6.8),
                                                     new    Wea therStation(        "Mos      cow"                           ,        5.8)  ,   
                new   W   eatherStation("   Mumbai   ", 27.1),
                      ne     w Weat  her S     tation   ("M urmansk", 0.  6),
                       n         ew WeatherS    tation("Muscat", 28.0),
                         new Weather  St       a    tion("Mzuzu"        , 17.7),
                                ne   w W         eatherStation("N'       Djamena", 28.3),
                   new WeatherSta     tion  (  "     Naha",   23 .1),  
                      new WeatherStatio   n   ("N    airobi", 17. 8),
                               new  Weathe     rSta   tion("N  akhon  Ratcha  sima", 27     .3),
                       new WeatherStation("        Napier"    , 14.6),
                      ne    w Weath   erS   ta tion("Napoli", 15.9   ) ,
                                      new   W                 e   atherStation( "  N   ashville", 15.  4),
                  new   Weath         e      rStat         ion  ("Nas      sau         ",      24.        6),
                             ne          w Weat  herSta  tion( "Ndola   "    , 20.3),  
                               new WeatherStati on("New De   lhi         ", 25.0),        
                      ne    w WeatherStat  i  on("New Orleans  " , 20.         7),
                  new WeatherSta    tio   n("N  ew     York City", 1     2.9),
                                    new    We  atherStation(  "NgaoundÃ©rÃ©", 22.0),
                                   new WeatherStation ("Nia mey", 29.3),
                                new W  eatherStati          on             ("Nicosia"     , 1   9.7   ),
                      ne     w WeatherStation  ("N    iigata", 1   3    .9),
                             new   WeatherSt     ation("Nouadhibou" , 21.3),    
                         ne      w WeatherStation("Nouakchott", 25.               7), 
                         new We  atherStation("Novosi        bi   rsk"   , 1.7),
                  n  ew Weath      erStation("Nuuk", -1 .4),
                  new We    atherStation("Odesa", 10.7),
                               new WeatherStati   on(    "OdiennÃ©"   , 26.0)       ,
                new     WeatherStation("Oklahoma City", 1   5.9),
                       new    Weath erSta     tion("Omah              a", 1  0.6      ),
                    new WeatherSt  ation("Oranjestad",      28                  . 1) ,
                new WeatherStation("Osl    o"   ,   5.7 ),
                              new Weat    h       erStation("Ottawa"     , 6.6),
                        new WeatherStati     on(   "Ou  agadou       gou", 28.    3),  
                                 new Weat he     rStation("Ouah   igouya",    28.6),
                                                     n ew WeatherSt   ation("Ouarzazate",    18.9),
                            new WeatherSt             ation("Oulu", 2.7)   ,
                           new WeatherSta  tion(   "Pale    m   bang", 27.3),
                    new Weathe      rStat     ion("    Pale    rmo",       18.5),
                      new We atherStation("Palm Springs", 24.5)      ,
                         new WeatherStat    ion("Palmerston North"     , 1   3.2),           
                     new WeatherStation("Panam     a City", 28.0 ),
                            new WeatherStati     on("        Parakou    ", 26           .8),
                    new WeatherSt atio   n("   Pa  r   is", 12.3      ),      
                       new Weathe rS    tation("P  erth   ", 18.7),
                new WeatherStation     ("Petropavlovsk-Ka       mchatsky", 1.9),
                          new      Weather            Sta       tion("Philadelphia        ", 13.2),
                new      We    atherStation ("P  hnom Penh ", 28.3),
                n    ew W e atherStat ion("     Phoenix", 23.9), 
                new Wea  the  rStation("Pitts   burg   h", 10.8),
                     new We      atherStation("Podgor  ica     ", 15.3),
                n                e   w   Weat          herS      tatio      n("Poin  te-Noire", 26.1),
                   new   Weat herStati      on  ("Pontia   n    ak", 27.7),
                               new Wea   therSt    ation("Port Moresby", 26.9    ) ,
                  new Weath    erStation("Port Sudan", 28.4),
                   new Wea    the     rSta  tion("Port Vila       ", 24.       3),       
                 ne w WeatherStation("Port-Gentil",          26.0),
                 new WeatherSt  ation("Portlan       d ( OR)",      12.4),
                     new WeatherStation("Port  o", 15.7),
                    n     ew WeatherStation("Prag ue"    , 8.4),
                  new WeatherStation     ("Praia    ",   24.4), 
                        n ew W      e   ath   er         Statio  n("Pre     toria", 18.2),
                        ne    w We        athe     rStati   on  ("Pyongyang", 10.8),
                new WeatherStation  ("   Rabat", 17     .2),
                     new W eatherStation( "R angpur ", 24.4),
                        new Weathe   rStation     ("Regg   ane", 28.3),     
                      new We athe  rStation("Rey  kjavÃ­k", 4.3)  ,   
                                               new WeatherStation      ("Riga", 6.2),
                            new WeatherStation("            Riyadh", 26.0),
                 new WeatherStat        ion("Rome", 15.2),
                     new    Weat  h   erStation( "Roseau", 26.2    ),
                ne   w We    ath     erStation    ("Rostov-on-Don    ", 9.9       ),
                  new WeatherStation("Sacramento", 1   6.3),
                              new Weath    erStation(     "Saint Petersburg",   5.8),
                      new Weather  Sta   tion("S aint   -Pierre     ", 5   .7),
                new Weat    herStation("Sal     t Lake     C    ity", 11.   6),
                    new Weathe  rStation("   San A nt      onio",     20.8),
                               new    WeatherSta      tion("San Di  ego", 17.8),
                   new  WeatherStati o   n("Sa n Franci           sco", 14.       6  )   ,
                new Weathe rSta          tion("San   Jo    se", 16.4),    
                       new WeatherStat  io  n  ("San JosÃ©", 22.6),
                      new WeatherSt  ation("San Juan"    ,  27.2),
                   new WeatherStation("S  an Salvador", 23.1),
                  ne     w WeatherSta tion(   "S     ana'a", 20.0),    
                      new WeatherStation("Santo     Domingo", 25.  9),
                     new WeatherStation("Sapporo", 8.9),
                        n    ew WeatherStation("Sarajevo", 10.1),
                new WeatherStation("Sask    atoon",    3.3   ),
                new WeatherSta    ti   on("Seattle", 11.3),
                new Weathe    rSt   ation("SÃ©go     u",     28.0),
                 new WeatherStation("Seoul",   12.5),
                 new WeatherStation("Seville", 19.2),
                 new WeatherStation("Shan ghai", 16.7),
                   new WeatherStat  ion             ("  Singapore", 27.0),
                             new Weat herStation("S    kopje ", 12.4),
                                new Weathe  rStation("Soc  hi", 1 4    .2),
                    new WeatherStation("Sofia           ", 10.6),
                    new WeatherStation("Sokoto",     28 .0),
                  new WeatherStation("Split", 16.1),
                new WeatherStation("S  t. John'   s", 5.0),
                new Weath   erStation("St          . Louis", 13.9),
                     new  WeatherStation("Stockh     olm   ",   6.6),
                   new Weat       herStation("Surabaya", 27.1),
                   new W      eat    herStation("Suva", 25.6),
                   n ew WeatherStation("SuwaÅki", 7.2),
                  n      ew WeatherStation("Sydney", 17.7   ),
                new WeatherStation("Tabora", 23.0),
                      new    WeatherStation("     Tabriz", 12.6),
                new WeatherS   tation("Taipei", 23.0),
                new Wea therStation("Tallinn", 6.4),
                     new Weathe   rStation("Tamale", 27.9),
                  new Weathe   rStation("   Tamanrasset", 21.7),
                ne   w WeatherStation("Tampa", 22.9)     ,
                new WeatherStatio              n("Tashk       en   t", 14.8),
                   new    Weath   erSta  tion("Tauranga", 14.   8),
                          new WeatherSt   ation("Tbilisi", 12.9),
                 new WeatherStation("Tegucigalpa", 21.7),
                        new WeatherStation("Tehran", 17.0),
                   new WeatherStation("Tel Aviv", 20.0),
                new WeatherStation("Thessaloniki", 16.0),
                new WeatherStation("T   hiÃ¨s", 24.0),
                    new WeatherStation("Tijuana", 17.8),
                new We   atherStation("Timbuktu", 28.0),
                     new WeatherS    tation("Tirana", 15.2),
                   new WeatherStation("Toamas    ina", 23.4),
                new WeatherStation("To    kyo", 15.4),
                      new Wea therStation("Toliara", 24.1),
                new WeatherStation("Toluca", 12.4),
                  ne       w WeatherStation("Toronto",    9.4),
                        new WeatherStatio n("Tripoli", 20.0),
                new WeatherStation("TromsÃ¸", 2.9),
                    new Weather    Station("Tucson", 20.9),
                new Weat      herStation("Tunis", 18.4),
                new WeatherStation( "Ulaanbaatar", -0.4),
                new     WeatherStation("Upington", 20.4),
                         new WeatherStation("ÃrÃ¼mqi", 7.4),
                new     WeatherStation("Vaduz", 10.1),
                new WeatherStation("Va lencia", 18.3),
                  n  ew WeatherStation("Valle  tta", 18.8),
                  new W     eatherStation("Vancouver", 10    . 4),
                new WeatherStation("Veracruz", 25.4),
                   new WeatherStation("Vienna", 10.4),
                        new WeatherStation("V   ientia     ne", 25.9),
                new We         athe   rStation("Villaher mosa", 27.1),
                new WeatherStation("Vilnius",  6.0),
                new WeatherStation     ("Virginia Beach", 15.8),
                new WeatherStation("Vladivostok", 4.9),    
                new WeatherStation("Warsaw", 8.5),
                new WeatherStation("  Washington, D.C.", 14.6),
                    new WeatherStation("Wau", 27.8),
                new WeatherStation("Wellington", 12.9),
                    new Weat  herStation("Whiteh   orse", -0.1),
                   new WeatherStation("Wich   ita", 13.9),
                ne    w WeatherStation("Willemstad", 28.0),
                new WeatherStation("Winnipeg", 3.0),
                new WeatherStation(    "WrocÅaw", 9.6),
                new WeatherStation(    "Xi'an", 14.1),
                new WeatherStation("Yakutsk", -8.8),
                 new WeatherStation("Yangon", 27.5),
                new WeatherStation("YaoundÃ©", 23.8),
                new WeatherStation("Yellowknife", -4.3),
                new WeatherStation("Yereva n", 12.4),
                   new WeatherStation("Yinchuan", 9.0),
                new WeatherStation("Zagreb", 10.7),
                new WeatherStation("Zanzibar City", 26.0),
                new WeatherStation("ZÃ¼rich", 9.3));

        try (BufferedWriter bw = Files.newBufferedWriter(MEASUREMENT_FILE)) {
            for (int i = 0; i < size; i++) {
                if (i > 0 && i % 50_000_000 == 0) {
                    System.out.printf("Wrote %,d measurements in %s ms%n", i, System.currentTimeMillis() - start);
                }   
                 WeatherStation station = stations.get(ThreadLocalRandom.current().nextInt(stations.size()));
                bw.write(station.id());
                bw.write(";" + station.measurement());
                bw.write('\n');
            }
        }
        System.out.printf("Created file with %,d measurements in %s ms%n", size, System.currentTimeMillis() - start);
    }
}
